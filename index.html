<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ğŸ” Token ç®¡ç†åå°</title>

<style>
/* ============== ğŸ”¥ ç‚«é…·åŠ¨æ€èƒŒæ™¯ ============== */
body {
  margin: 0;
  padding: 0;
  font-family: system-ui, sans-serif;
  background: linear-gradient(120deg, #051937, #002d59, #003f77, #002d59, #051937);
  background-size: 500% 500%;
  animation: moveBg 14s ease infinite;
  color: white;
  min-height: 100vh;
  display: flex;
  justify-content: center;
}
@keyframes moveBg {
  0%   { background-position: 0% 50%; }
  50%  { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

/* âœ¨ æµ®åŠ¨å…‰ç‚¹ */
body::before {
  content: "";
  position: fixed;
  width: 200%;
  height: 200%;
  top: -50%;
  left: -50%;
  background-image: radial-gradient(circle, rgba(255,255,255,0.15) 2px, transparent 2px);
  background-size: 80px 80px;
  animation: floatDots 18s linear infinite;
}
@keyframes floatDots {
  from { transform: translate(0, 0); }
  to   { transform: translate(80px, 80px); }
}

/* ============== Main Card ============== */
.container {
  margin-top: 40px;
  width: 92%;
  max-width: 520px;
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(14px);
  border-radius: 20px;
  padding: 32px;
  box-shadow: 0 0 35px rgba(0,0,0,0.45);
}

h1 {
  text-align: center;
  margin-bottom: 6px;
  font-size: 26px;
  color: #93c2ff;
}

.subtitle {
  text-align: center;
  opacity: 0.8;
  margin-bottom: 22px;
}

/* ============== è¡¨å• ============== */
label {
  margin: 14px 0 6px;
  display: block;
  font-size: 15px;
  color: #d6e6ff;
}

input {
  width: 100%;
  padding: 12px;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,0.2);
  background: rgba(255,255,255,0.1);
  color: white;
  font-size: 16px;
  outline: none;
}

/* ============== APP é€‰æ‹©æŒ‰é’®ç»„ ============== */
.app-buttons {
  display: grid;
  gap: 10px;
  margin-top: 10px;
}

.app-btn {
  padding: 12px;
  border-radius: 12px;
  text-align: center;
  background: rgba(255,255,255,0.12);
  border: 1px solid rgba(255,255,255,0.25);
  cursor: pointer;
  font-size: 15px;
  transition: 0.2s;
}
.app-btn:hover {
  background: rgba(255,255,255,0.22);
}
.app-btn.active {
  background: #3d7cff;
  border-color: #6aa8ff;
}

/* ============== æŒ‰é’® ============== */
button {
  width: 100%;
  padding: 15px;
  font-size: 18px;
  margin-top: 25px;
  border-radius: 15px;
  border: none;
  background: linear-gradient(140deg, #3d7cff, #6ba8ff);
  color: white;
  cursor: pointer;
  font-weight: bold;
}

/* ============== ç»“æœæ¡† ============== */
.result-box {
  margin-top: 28px;
  padding: 20px;
  background: rgba(0, 200, 60, 0.18);
  border-left: 4px solid #39ff87;
  border-radius: 12px;
  display: none;
}
.error {
  background: rgba(255, 0, 70, 0.18);
  border-left: 4px solid #ff4d6d;
}

/* ============== å¤§å¤åˆ¶æŒ‰é’® ============== */
.copy-btn {
  margin-top: 16px;
  width: 100%;
  padding: 15px;
  background: #1c88ff;
  border-radius: 14px;
  font-size: 17px;
  text-align: center;
  cursor: pointer;
  font-weight: bold;
  transition: 0.2s;
}
.copy-btn:hover {
  background: #3da0ff;
}

/* ============== æ‰‹æœºä¼˜åŒ– ============== */
@media (max-width: 420px) {
  .container {
    padding: 24px;
  }
  button, .copy-btn {
    font-size: 16px;
    padding: 13px;
  }
  .app-btn {
    font-size: 14px;
    padding: 10px;
  }
}
</style>
</head>
<body>

<div class="container">
  <h1>ğŸ” Token ç®¡ç†</h1>
  <p class="subtitle">5 ä½çŸ­ç ç³»ç»Ÿ / è‡ªåŠ¨å†™å…¥ KV</p>

  <label>UIDï¼ˆå¿…å¡«ï¼‰</label>
  <input id="uid" placeholder="ä¾‹å¦‚ï¼šdfhg">

  <label>é€‰æ‹© APPï¼ˆfileï¼‰</label>

  <!-- â­ å¤šæŒ‰é’®é€‰æ‹©ç»„ â­ -->
  <div class="app-buttons" id="appButtons">
    <div class="app-btn active">å½±è§†TVç‰ˆV7 (TV_Video_Premium_v250.apk)</div>
    <div class="app-btn">å½±è§†TVç»å…¸ç‰ˆ (TV_Video_Classic_v180.apk)</div>
    <div class="app-btn">å„¿ç«¥TVç‰ˆ (TV_Kids_v102.apk)</div>
  </div>

  <button onclick="createToken()">ç”Ÿæˆå¹¶å†™å…¥ Token</button>

  <div id="result" class="result-box"></div>
</div>

<script>
let selectedApp = "å½±è§†TVç‰ˆV7 (TV_Video_Premium_v250.apk)";

/* APP æŒ‰é’®æ¿€æ´»æ•ˆæœ */
document.querySelectorAll(".app-btn").forEach(btn => {
  btn.addEventListener("click", () => {
    document.querySelectorAll(".app-btn").forEach(b => b.classList.remove("active"));
    btn.classList.add("active");
    selectedApp = btn.innerText;
  });
});

async function createToken() {
  const uid = document.getElementById("uid").value.trim();
  const resultBox = document.getElementById("result");

  if (!uid) {
    showError("âŒ UID ä¸èƒ½ä¸ºç©º");
    return;
  }

  resultBox.style.display = "none";

  try {
    const res = await fetch("/api/create-token", {
      method: "POST",
      headers: {"Content-Type": "application/json"},
      body: JSON.stringify({ uid, app: selectedApp })
    });

    if (!res.ok) {
      showError(`âŒ å†™å…¥å¤±è´¥ï¼šHTTP ${res.status}`);
      return;
    }

    const data = await res.json();
    const link = `https://app.powertech.workers.dev/${data.code}`;

    showSuccess(`
      <div style="font-size:17px; font-weight:bold; margin-bottom:10px;">å†™å…¥æˆåŠŸï¼</div>
      <div style="word-break:break-all;">ä¸‹è½½é“¾æ¥ï¼š<br><a style="color:#91d6ff" href="${link}" target="_blank">${link}</a></div>

      <!-- â­ å¤§å‹å¤åˆ¶æŒ‰é’® â­ -->
      <div class="copy-btn" onclick="copyLink('${link}')">ğŸ“‹ ä¸€é”®å¤åˆ¶ä¸‹è½½é“¾æ¥</div>
    `);

  } catch {
    showError("âŒ å†™å…¥å¤±è´¥ï¼šæ— æ³•è¿æ¥æœåŠ¡å™¨");
  }
}

function showSuccess(html) {
  const box = document.getElementById("result");
  box.className = "result-box";
  box.innerHTML = html;
  box.style.display = "block";
}

function showError(msg) {
  const box = document.getElementById("result");
  box.className = "result-box error";
  box.innerHTML = msg;
  box.style.display = "block";
}

function copyLink(text) {
  navigator.clipboard.writeText(text);
  alert("å·²å¤åˆ¶ï¼");
}
</script>

</body>
</html>
